{"ast":null,"code":"import _assertThisInitialized from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _classCallCheck from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/pramuditha/Desktop/VX Leave/front_end/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/pramuditha/Desktop/VX Leave/front_end/src/components/Settings/LeaveCalender.js\";\nimport React from 'react';\nimport 'antd/dist/antd.css';\nimport axios from '../../config/axios';\nimport './index.css';\nimport { Calendar, Card, Modal, Form, Input, message, Badge, Icon, Spin } from 'antd';\nvar confirm = Modal.confirm;\nvar ReasonForm = Form.create({\n  name: 'form_in_modal'\n})(\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(_class, _React$Component);\n\n  function _class() {\n    _classCallCheck(this, _class);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(_class).apply(this, arguments));\n  }\n\n  _createClass(_class, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          visible = _this$props.visible,\n          onCancel = _this$props.onCancel,\n          onCreate = _this$props.onCreate,\n          form = _this$props.form,\n          date = _this$props.date;\n      var getFieldDecorator = form.getFieldDecorator;\n      var txt = \"Set leave on \".concat(date);\n      return React.createElement(Modal, {\n        visible: visible,\n        title: txt,\n        okText: \"Save\",\n        onCancel: onCancel,\n        onOk: onCreate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 17\n        },\n        __self: this\n      }, React.createElement(Form, {\n        layout: \"vertical\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 24\n        },\n        __self: this\n      }, React.createElement(Form.Item, {\n        label: \"Reason for give leave\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 25\n        },\n        __self: this\n      }, getFieldDecorator('reason', {\n        rules: [{\n          required: true,\n          message: 'Please input the reason'\n        }]\n      })(React.createElement(Input, {\n        type: \"textarea\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 28\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return _class;\n}(React.Component));\n\nvar LeaveCalender =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(LeaveCalender, _React$Component2);\n\n  function LeaveCalender() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LeaveCalender);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LeaveCalender)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      saveDates: [],\n      dates: [],\n      selectedValue: null,\n      visible: false,\n      res: false\n    };\n\n    _this.onSelect = function (value) {\n      if (!_this.state.dates.includes(value.format('YYYY-MM-DD'))) {\n        _this.setState({\n          selectedValue: value.format('YYYY-MM-DD'),\n          visible: true\n        });\n      }\n    };\n\n    _this.handleCancel = function () {\n      var form = _this.formRef.props.form;\n      form.resetFields();\n\n      _this.setState({\n        visible: false\n      });\n    };\n\n    _this.handleSet = function () {\n      var form = _this.formRef.props.form;\n      form.validateFields(function (err, values) {\n        var calendar = {\n          date: _this.state.selectedValue,\n          reason: values.reason\n        };\n\n        if (!err) {\n          axios.post('calender/set_date', calendar, {\n            headers: {\n              Authorization: 'Bearer ' + localStorage.getItem(\"header\")\n            }\n          }).then(function (res) {\n            if (res.data.success === true) {\n              message.success(res.data.message);\n\n              _this.reload();\n\n              _this.handleCancel();\n            } else {\n              message.error(res.data.message);\n            }\n          }).catch(function (e) {\n            message.error(e.response.data.error);\n          });\n        }\n      });\n    };\n\n    _this.saveFormRef = function (formRef) {\n      _this.formRef = formRef;\n    };\n\n    _this.showConfirm = function (day) {\n      console.log(day.id);\n\n      _this.setState({\n        visible: false\n      });\n\n      confirm({\n        title: 'Do you want to remove this holiday ?',\n        okText: 'Remove',\n        okType: 'danger',\n        onOk: function onOk() {\n          axios.get('calender/delete/' + day.id, {\n            headers: {\n              Authorization: 'Bearer ' + localStorage.getItem(\"header\")\n            }\n          }).then(function (res) {\n            if (res.data.success === true) {\n              message.success(res.data.message);\n\n              _this.reload();\n\n              _this.handleCancel();\n            } else {\n              message.error(res.data.message);\n            }\n          }).catch(function (e) {\n            message.error(e.response.data.error);\n          });\n        },\n        onCancel: function onCancel() {}\n      });\n    };\n\n    _this.dateCellRender = function (value) {\n      return React.createElement(\"ul\", {\n        className: \"events\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, _this.state.saveDates.map(function (item) {\n        return item.date === value.format('YYYY-MM-DD') ? React.createElement(\"li\", {\n          key: item.date,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, React.createElement(Badge, {\n          status: \"success\",\n          text: item.reason,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        }), React.createElement(Badge, {\n          status: \"warning\",\n          text: item.createdBy,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }), React.createElement(Badge, {\n          status: \"warning\",\n          text: item.createdAt,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185\n          },\n          __self: this\n        }), React.createElement(Icon, {\n          type: \"delete\",\n          onClick: _this.showConfirm.bind(_assertThisInitialized(_assertThisInitialized(_this)), item),\n          theme: \"twoTone\",\n          twoToneColor: \"#EE204D\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        })) : null;\n      }));\n    };\n\n    return _this;\n  }\n\n  _createClass(LeaveCalender, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.reload();\n    }\n  }, {\n    key: \"reload\",\n    value: function reload() {\n      var _this2 = this;\n\n      axios.get('calender/all', {\n        headers: {\n          Authorization: 'Bearer ' + localStorage.getItem(\"header\")\n        }\n      }).then(function (res) {\n        if (res.data.success === true) {\n          _this2.setState({\n            saveDates: res.data.list,\n            res: true\n          });\n        } else {\n          message.error(res.data.message);\n        }\n      }).catch(function (e) {\n        console.log(e.response);\n      });\n      axios.get('calender/dates', {\n        headers: {\n          Authorization: 'Bearer ' + localStorage.getItem(\"header\")\n        }\n      }).then(function (res) {\n        if (res.data.success === true) {\n          _this2.setState({\n            dates: res.data.list\n          });\n        } else {\n          message.error(res.data.message);\n        }\n      }).catch(function (e) {\n        console.log(e.response);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, this.state.data.length !== 0 ? React.createElement(Card, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(Calendar, {\n        onSelect: this.onSelect,\n        dateCellRender: this.dateCellRender,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      })) : React.createElement(\"div\", {\n        className: \"example\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(Spin, {\n        size: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      })), React.createElement(ReasonForm, {\n        wrappedComponentRef: this.saveFormRef,\n        visible: this.state.visible,\n        onCancel: this.handleCancel,\n        onCreate: this.handleSet,\n        date: this.state.selectedValue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return LeaveCalender;\n}(React.Component);\n\nvar WrappedLeaveCalender = Form.create({\n  name: 'calender'\n})(LeaveCalender);\nexport default WrappedLeaveCalender;","map":{"version":3,"sources":["/home/pramuditha/Desktop/VX Leave/front_end/src/components/Settings/LeaveCalender.js"],"names":["React","axios","Calendar","Card","Modal","Form","Input","message","Badge","Icon","Spin","confirm","ReasonForm","create","name","props","visible","onCancel","onCreate","form","date","getFieldDecorator","txt","rules","required","Component","LeaveCalender","state","saveDates","dates","selectedValue","res","onSelect","value","includes","format","setState","handleCancel","formRef","resetFields","handleSet","validateFields","err","values","calendar","reason","post","headers","Authorization","localStorage","getItem","then","data","success","reload","error","catch","e","response","saveFormRef","showConfirm","day","console","log","id","title","okText","okType","onOk","get","dateCellRender","map","item","createdBy","createdAt","bind","list","length","WrappedLeaveCalender"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport axios from '../../config/axios';\r\nimport './index.css';\r\nimport { Calendar, Card, Modal, Form, Input, message, Badge, Icon, Spin } from 'antd';\r\n\r\nconst { confirm } = Modal;\r\n\r\nconst ReasonForm = Form.create({ name: 'form_in_modal' })(\r\n\r\n  class extends React.Component {\r\n    render() {\r\n      const { visible, onCancel, onCreate, form, date } = this.props;\r\n      const { getFieldDecorator } = form;\r\n      const txt = `Set leave on ${date}`\r\n      return (\r\n        <Modal\r\n          visible={visible}\r\n          title={txt}\r\n          okText=\"Save\"\r\n          onCancel={onCancel}\r\n          onOk={onCreate}\r\n        >\r\n          <Form layout=\"vertical\">\r\n            <Form.Item label=\"Reason for give leave\">\r\n              {getFieldDecorator('reason', {\r\n                rules: [{ required: true, message: 'Please input the reason' }],\r\n              })(<Input type=\"textarea\"/>)}\r\n            </Form.Item>\r\n          </Form>\r\n        </Modal>\r\n      );\r\n    }\r\n  },\r\n);\r\n\r\nclass LeaveCalender extends React.Component {\r\n\r\n  componentWillMount () {\r\n    this.reload();\r\n  }\r\n  \r\n  reload () {\r\n    axios.get('calender/all', \r\n    {\r\n        headers: {\r\n            Authorization: 'Bearer ' + localStorage.getItem(\"header\")\r\n        }\r\n    })\r\n    .then(res => {\r\n      if(res.data.success === true){\r\n        this.setState({\r\n          saveDates : res.data.list,\r\n          res : true\r\n        });\r\n      }  else{\r\n        message.error(res.data.message); \r\n      }\r\n    }).catch(e => {\r\n      console.log(e.response);\r\n    })\r\n\r\n    axios.get('calender/dates', \r\n    {\r\n        headers: {\r\n            Authorization: 'Bearer ' + localStorage.getItem(\"header\")\r\n        }\r\n    })\r\n    .then(res => {\r\n      if(res.data.success === true){\r\n        this.setState({\r\n          dates : res.data.list\r\n        });\r\n      }  else{\r\n        message.error(res.data.message); \r\n      }\r\n    }).catch(e => {\r\n      console.log(e.response);\r\n    })\r\n  }\r\n\r\n  state = {\r\n    saveDates: [],\r\n    dates: [],\r\n    selectedValue: null,\r\n    visible: false,\r\n    res : false\r\n  };\r\n\r\n  onSelect = value => {\r\n    if(!this.state.dates.includes(value.format('YYYY-MM-DD'))){\r\n      this.setState({\r\n        selectedValue: value.format('YYYY-MM-DD'),\r\n        visible: true\r\n      })\r\n    }\r\n  };\r\n\r\n  handleCancel = () => {\r\n    const { form } = this.formRef.props;\r\n    form.resetFields(); \r\n    this.setState({ \r\n      visible: false\r\n    });\r\n  };\r\n\r\n  handleSet = () => {\r\n    const { form } = this.formRef.props;\r\n    form.validateFields((err, values) => {\r\n\r\n      const calendar = {\r\n        date: this.state.selectedValue,  \r\n        reason : values.reason\r\n      }\r\n\r\n      if (!err) {\r\n        axios.post('calender/set_date', \r\n        calendar,\r\n        {\r\n            headers: {\r\n                Authorization: 'Bearer ' + localStorage.getItem(\"header\")\r\n            }\r\n        })\r\n        .then(res => {\r\n            if(res.data.success === true){\r\n              message.success(res.data.message);\r\n              this.reload();\r\n              this.handleCancel();\r\n            }  else{\r\n              message.error(res.data.message); \r\n            }\r\n        }).catch(e => {\r\n          message.error(e.response.data.error); \r\n        })\r\n        \r\n      }\r\n    });\r\n  }\r\n\r\n  saveFormRef = formRef => {\r\n    this.formRef = formRef;\r\n  };\r\n\r\n  showConfirm = (day) =>{\r\n    console.log(day.id)\r\n    this.setState({\r\n      visible: false\r\n    })\r\n    confirm({\r\n      title: 'Do you want to remove this holiday ?',\r\n      okText: 'Remove',\r\n      okType: 'danger',\r\n      onOk: () => {\r\n        axios.get('calender/delete/'+day.id, \r\n        {\r\n            headers: {\r\n                Authorization: 'Bearer ' + localStorage.getItem(\"header\")\r\n            }\r\n        })\r\n        .then(res => {\r\n              if(res.data.success === true){\r\n                message.success(res.data.message);\r\n                this.reload();\r\n                this.handleCancel();\r\n              }  else{\r\n                message.error(res.data.message); \r\n              }\r\n        }).catch( e => {\r\n            message.error(e.response.data.error);\r\n        })\r\n      },\r\n      onCancel() {\r\n      },\r\n    });\r\n  }\r\n\r\n  dateCellRender = (value) => {\r\n    return (\r\n          <ul className=\"events\">\r\n            {this.state.saveDates.map(item => (\r\n              item.date === value.format('YYYY-MM-DD')?\r\n              <li key={item.date}>\r\n                <Badge status='success' text={item.reason} />\r\n                <Badge status='warning' text={item.createdBy} />\r\n                <Badge status='warning' text={item.createdAt} />\r\n                <Icon type=\"delete\" onClick={this.showConfirm.bind(this, item)}  theme=\"twoTone\" twoToneColor='#EE204D'/>\r\n              </li>\r\n              :null\r\n            ))}\r\n          </ul>\r\n        );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n      { this.state.data.length !== 0? \r\n        <Card>\r\n          <Calendar onSelect={this.onSelect} dateCellRender={this.dateCellRender} />\r\n        </Card>\r\n      : \r\n      <div className=\"example\">\r\n        <Spin size=\"large\" />\r\n      </div>\r\n      } \r\n        <ReasonForm\r\n          wrappedComponentRef={this.saveFormRef}\r\n          visible={this.state.visible}\r\n          onCancel={this.handleCancel}\r\n          onCreate={this.handleSet}\r\n          date={this.state.selectedValue}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nconst WrappedLeaveCalender = Form.create({ name: 'calender' })(LeaveCalender);\r\n\r\nexport default WrappedLeaveCalender;"]},"metadata":{},"sourceType":"module"}